# Python Core Exploits

This directory contains POC (Proof of Concept) exploit scripts for various CVEs.

## Structure

```
exploits/
├── shared/                    # Shared utilities (reusable)
│   ├── __init__.py
│   ├── theme.py              # ANSI color themes
│   ├── signature.py          # Branding and signatures
│   └── banner.py             # Display utilities
│
└── [exploit-name]/           # Individual exploit directories
    ├── exploit.py            # Main exploit script
    └── README.md             # Exploit documentation
```

## Current Exploits

### 1. React2Shell (CVE-2025-55182)

**Directory**: `react2shell/`

Next.js React Server Components RCE exploit.

- **Severity**: CRITICAL (CVSS 9.8)
- **Language**: Python
- **Usage**: `python exploit.py -t <target> -c <command>`

[View Details →](react2shell/README.md)

## Shared Utilities

All exploits use dependency injection with shared utility modules for consistency and code reuse.

### Theme Module (`shared/theme.py`)

Terminal color theming with ANSI codes.

```python
from exploits.shared import Theme

# Use predefined colors
print(f"{Theme.OKGREEN}Success!{Theme.ENDC}")

# Or use helper methods
print(Theme.success("Operation completed"))
print(Theme.error("Something went wrong"))
print(Theme.info("Processing..."))
print(Theme.warning("Be careful!"))
```

**Features:**

- ANSI color codes (GREEN, RED, CYAN, YELLOW, etc.)
- Helper methods for common message types
- Consistent styling across all exploits

### Signature Module (`shared/signature.py`)

Branding and tool signature information.

```python
from exploits.shared import Signature

# Initialize with tool details
sig = Signature(
    tool_name="CVE-2025-XXXXX RCE Exploit",
    version="1.0",
    exploit_name="MyExploit"
)

# Display banner
print(sig.get_banner(ascii_art="..."))

# Show footer
print(sig.get_footer())
```

**Features:**

- Consistent author branding
- Customizable tool information
- Banner and footer generation
- ASCII art support

### BannerDisplay Module (`shared/banner.py`)

Standardized UI displays for exploit scripts.

```python
from exploits.shared import Signature, BannerDisplay

sig = Signature("My Tool", "1.0")
display = BannerDisplay(sig)

# Show header
display.show_header(ascii_art="...")

# Show configuration
display.show_config({
    "target": "http://example.com",
    "command": "whoami"
})

# Show results
display.show_success("root")
display.show_failure("timeout", "Connection timed out")
display.show_info("Processing request...")
display.show_warning("Target may be protected")
```

**Features:**

- Consistent output formatting
- Success/failure reporting
- Configuration display
- Info and warning messages

## Creating New Exploits

### Step 1: Create Directory

```bash
mkdir exploits/my-exploit
cd exploits/my-exploit
```

### Step 2: Create Exploit Script

**Template** (`exploit.py`):

```python
#!/usr/bin/env python3
"""
CVE-XXXX-XXXXX - Description
Tool by: cybertechmind.com
"""

import argparse
import sys
from pathlib import Path

# Add parent directory to path for imports
sys.path.insert(0, str(Path(__file__).parent.parent))

from shared import Theme, Signature, BannerDisplay

# ASCII Art (optional)
ASCII_ART = """
  _____ _   _       _   _
 |  ___| | | |_ __ | |_(_)_ __   __ _
 | |_  | | | | '_ \| __| | '_ \ / _` |
 |  _| | |_| | | | | |_| | | | | (_| |
 |_|    \___/|_| |_|\__|_|_| |_|\__, |
                                 |___/
"""

class ExploitConfig:
    """Configuration for your exploit"""
    def __init__(self):
        self.target_url = None
        # Add your config parameters

class ExploitEngine:
    """Main exploitation engine"""
    def __init__(self, config, display):
        self.config = config
        self.display = display

    def execute(self):
        """Execute the exploit"""
        self.display.show_info("Starting exploitation...")

        try:
            # Your exploitation logic here
            result = "Success output"
            return True, 'success', result
        except Exception as e:
            return False, 'unknown', str(e)

def main():
    # Initialize signature
    sig = Signature(
        tool_name="CVE-XXXX-XXXXX Exploit",
        version="1.0",
        exploit_name="MyExploit"
    )

    # Initialize display
    display = BannerDisplay(sig)
    display.show_header(ASCII_ART)

    # Parse arguments
    parser = argparse.ArgumentParser(
        description=sig.tool_name,
        epilog=sig.get_footer()
    )
    parser.add_argument('-t', '--target', required=True, help='Target URL')
    args = parser.parse_args()

    # Configure
    config = ExploitConfig()
    config.target_url = args.target

    # Show config
    display.show_config({'target': config.target_url})

    # Execute
    engine = ExploitEngine(config, display)
    success, status, data = engine.execute()

    # Display results
    if success:
        display.show_success(data)
        sys.exit(0)
    else:
        display.show_failure(status, data)
        sys.exit(1)

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print(f"\n{Theme.WARNING}[!] Interrupted by user{Theme.ENDC}\n")
        sys.exit(130)
    except Exception as e:
        print(f"\n{Theme.FAIL}[!] Fatal error: {e}{Theme.ENDC}\n")
        sys.exit(1)
```

### Step 3: Create README

Document your exploit with:

- Vulnerability details
- Usage examples
- Installation requirements
- How it works
- Integration notes

See [react2shell/README.md](react2shell/README.md) as a reference.

### Step 4: Test

```bash
python exploit.py -t http://test-target.com
```

## Execution

Exploits can be executed in multiple ways:

### 1. Direct CLI Execution

```bash
cd exploits/react2shell
python exploit.py -t http://target.com -c "whoami"
```

### 2. Via Bug Hunting Platform API

```bash
curl -X POST http://localhost:3000/api/pocs/[id]/execute \
  -H "Content-Type: application/json" \
  -d '{"targetUrl": "http://target.com", "command": "whoami"}'
```

### 3. Via Python Core FastAPI

```bash
curl -X POST http://localhost:8000/execute \
  -H "Content-Type: application/json" \
  -d '{
    "scriptPath": "/app/exploits/react2shell/exploit.py",
    "targetUrl": "http://target.com",
    "command": "whoami"
  }'
```

### 4. Via Web UI

Upload and execute through the Bug Hunting Platform frontend at http://localhost:5173

## Best Practices

### Code Organization

1. ✅ Use shared utilities (Theme, Signature, BannerDisplay)
2. ✅ Separate configuration from logic
3. ✅ Implement proper error handling
4. ✅ Add timeout protection
5. ✅ Document code thoroughly

### Security

1. ✅ Validate all inputs
2. ✅ Sanitize commands and payloads
3. ✅ Implement timeout mechanisms
4. ✅ Handle SSL/TLS errors gracefully
5. ✅ Log all execution attempts

### Documentation

1. ✅ Include comprehensive README
2. ✅ Document usage examples
3. ✅ Explain vulnerability details
4. ✅ Provide troubleshooting guide
5. ✅ Add author attribution

## Integration with Platform

All exploits are automatically integrated into the Bug Hunting Platform:

- **Database**: Stored in `pocs` table with metadata
- **File Storage**: Scripts stored in platform uploads directory
- **Execution**: Handled by Python Core FastAPI service
- **Logging**: All executions logged in `execution_logs` table
- **Security**: Timeout protection and isolated execution

## Author

**Moovendhan V**  
Website: www.cybertechmind.com  
Profile: profile.cybertechmind.com

---

> [!WARNING] > **Legal Notice**
>
> All exploits are for authorized security testing only. Unauthorized access to computer systems is illegal under applicable laws. Always obtain proper written authorization before conducting security assessments.
