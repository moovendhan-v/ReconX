"""
Exploit Registry - Real CVE Tools Only
"""

EXPLOIT_REGISTRY = {
    # CVE-2025-55182: React Server Components RCE
    'react2shell': {
        'id': 'react2shell',
        'name': 'React Server Components RCE (React2Shell)',
        'cve': 'CVE-2025-55182',
        'category': 'Framework',
        'severity': 'CRITICAL',
        'cvss': 9.8,
        'command': ['python3', '-m', 'cybertechmind_cve_2025_55182.cli', '-t', '{target}', '-c', '{cmd}'],
        'params': ['cmd'],  # Only cmd needed, target comes from batch request
        'description': 'Exploits React Server Components vulnerability in Next.js applications for remote code execution',
        'timeout': 30,
        'enabled': True,
        'author': 'Moovendhan V (CyberTechMind)',
        'requires_specific_setup': True  # Needs vulnerable Next.js app
    },
    
    # Git Exposure Scanner
    'git-scanner': {
        'id': 'git-scanner',
        'name': 'Git Directory Exposure Scanner',
        'cve': 'GIT-EXPOSURE',
        'category': 'InfoLeak',
        'severity': 'HIGH',
        'cvss': 7.5,
        'command': ['python3', '-m', 'ctm_git_exposure.cli', '-t', '{target}'],
        'params': [],  # Only target needed (auto-filled)
        'description': 'Scans for exposed .git directories and extracts sensitive data including secrets, contributors, and deployment info',
        'timeout': 45,
        'enabled': True,
        'author': 'Moovendhan V (CyberTechMind)',
        'features': [
            'Detects 25+ types of secrets (AWS, API keys, tokens)',
            'Extracts contributor information',
            'Identifies deployment environments',
            'Downloads full repository with --dump flag'
        ]
    }
}


def get_all_exploits():
    """Get all exploits with metadata"""
    return [
        {
            'id': exploit['id'],
            'name': exploit['name'],
            'cve': exploit['cve'],
            'category': exploit['category'],
            'severity': exploit['severity'],
            'cvss': exploit['cvss'],
            'params': exploit['params'],
            'description': exploit['description'],
            'enabled': exploit['enabled'],
            'author': exploit.get('author', 'Unknown'),
            'features': exploit.get('features', []),
            'requires_specific_setup': exploit.get('requires_specific_setup', False)
        }
        for exploit in EXPLOIT_REGISTRY.values()
        if exploit.get('enabled', True)
    ]


def get_exploit(exploit_id: str):
    """Get specific exploit by ID"""
    return EXPLOIT_REGISTRY.get(exploit_id)


def get_exploits_by_category(category: str):
    """Get exploits filtered by category"""
    return [
        exp for exp in get_all_exploits()
        if exp['category'] == category
    ]


def get_exploits_by_severity(severity: str):
    """Get exploits filtered by severity"""
    return [
        exp for exp in get_all_exploits()
        if exp['severity'] == severity
    ]
