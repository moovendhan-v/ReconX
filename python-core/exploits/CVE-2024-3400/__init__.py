"""CVE-2024-3400 - Palo Alto PAN-OS Command Injection RCE"""

from dataclasses import dataclass
from typing import List
from datetime import datetime


@dataclass
class CVEMetadata:
    cve_id: str
    title: str
    description: str
    severity: str
    cvss_score: float
    published_date: datetime
    affected_products: List[str]
    references: List[str]
    def to_dict(self): return {'cveId': self.cve_id, 'title': self.title, 'description': self.description, 'severity': self.severity, 'cvssScore': str(self.cvss_score), 'publishedDate': self.published_date.isoformat(), 'affectedProducts': self.affected_products, 'references': self.references}


@dataclass
class ToolMetadata:
    tool_name: str
    version: str
    exploit_name: str
    language: str
    author: str
    website: str
    profile: str
    def to_dict(self): return {'name': self.tool_name, 'version': self.version, 'exploitName': self.exploit_name, 'language': self.language, 'author': self.author}


CVE = CVEMetadata(
    cve_id="CVE-2024-3400",
    title="Palo Alto PAN-OS GlobalProtect Command Injection",
    description="Critical unauthenticated command injection in Palo Alto Networks PAN-OS GlobalProtect gateway allowing root-level code execution.",
    severity="CRITICAL",
    cvss_score=10.0,
    published_date=datetime(2024, 4, 12),
    affected_products=["PAN-OS 11.1 < 11.1.2-h3", "PAN-OS 11.0 < 11.0.4-h1", "PAN-OS 10.2 < 10.2.9-h1"],
    references=["https://nvd.nist.gov/vuln/detail/CVE-2024-3400", "https://security.paloaltonetworks.com/CVE-2024-3400"]
)

TOOL = ToolMetadata(
    tool_name="CVE-2024-3400 PAN-OS Exploit",
    version="1.0",
    exploit_name="PaloShell",
    language="python",
    author="Moovendhan V",
    website="www.cybertechmind.com",
    profile="profile.cybertechmind.com"
)

ASCII_ART = """
█▀█ ▄▀▄ █   ▄▀▄ ▄▀▀ █▄█ ██▀ █   █  
█▀▀ █▀█ █▄▄ ▀▄▀ ▄██ █ █ █▄▄ █▄▄ █▄▄
"""

USAGE_EXAMPLES = """
Examples:
  exploit.py -t https://vpn.target.com -c "whoami"
  exploit.py -t https://firewall.company.com -c "id"
"""

POC_METADATA = {
    'name': 'PaloShell - CVE-2024-3400 Exploit',
    'description': 'Exploits command injection in PAN-OS GlobalProtect for RCE with root privileges.',
    'language': 'python',
    'usageExamples': USAGE_EXAMPLES.strip(),
    'author': TOOL.author
}

EXPLOIT_CONFIG = {'timeout': 15, 'default_protocol': 'https', 'globalprotect_endpoint': '/global-protect/portal/images/', 'verify_ssl': False}

__all__ = ['CVE', 'TOOL', 'ASCII_ART', 'POC_METADATA', 'EXPLOIT_CONFIG']

def get_full_metadata():
    return {'cve': CVE.to_dict(), 'tool': TOOL.to_dict(), 'poc': POC_METADATA, 'config': EXPLOIT_CONFIG}
