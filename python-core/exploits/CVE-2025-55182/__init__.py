"""
CVE-2025-55182 - Next.js React Server Components RCE
Exploit configuration and metadata

This module contains all the configuration and metadata for the CVE-2025-55182 exploit.
Import this module to access CVE details, tool information, and ASCII art.
"""

from dataclasses import dataclass
from typing import List, Optional
from datetime import datetime


@dataclass
class CVEMetadata:
    """CVE vulnerability metadata"""
    cve_id: str
    title: str
    description: str
    severity: str  # LOW, MEDIUM, HIGH, CRITICAL
    cvss_score: float
    published_date: datetime
    affected_products: List[str]
    references: List[str]
    
    def to_dict(self):
        """Convert to dictionary for API/database usage"""
        return {
            'cveId': self.cve_id,
            'title': self.title,
            'description': self.description,
            'severity': self.severity,
            'cvssScore': str(self.cvss_score),
            'publishedDate': self.published_date.isoformat(),
            'affectedProducts': self.affected_products,
            'references': self.references
        }


@dataclass
class ToolMetadata:
    """Exploit tool metadata"""
    tool_name: str
    version: str
    exploit_name: str
    language: str
    author: str
    website: str
    profile: str
    
    def to_dict(self):
        """Convert to dictionary for API/database usage"""
        return {
            'name': self.tool_name,
            'version': self.version,
            'exploitName': self.exploit_name,
            'language': self.language,
            'author': self.author
        }


# CVE Information
CVE = CVEMetadata(
    cve_id="CVE-2025-55182",
    title="Next.js React Server Components Remote Code Execution",
    description=(
        "A critical remote code execution vulnerability in Next.js React Server Components "
        "that allows attackers to execute arbitrary code on the server through crafted "
        "malicious payloads. The vulnerability exists in the server-side rendering mechanism "
        "and can be exploited by injecting malicious JavaScript code that spawns child processes."
    ),
    severity="CRITICAL",
    cvss_score=9.8,
    published_date=datetime(2025, 1, 15),
    affected_products=[
        "Next.js 13.x",
        "Next.js 14.x", 
        "Next.js 15.x"
    ],
    references=[
        "https://nvd.nist.gov/vuln/detail/CVE-2025-55182",
        "https://github.com/vercel/next.js/security/advisories"
    ]
)


# Tool Information
TOOL = ToolMetadata(
    tool_name="CVE-2025-55182 RSC-RCE Exploit",
    version="1.0",
    exploit_name="React2Shell",
    language="python",
    author="Moovendhan V",
    website="www.cybertechmind.com",
    profile="profile.cybertechmind.com"
)


# ASCII Art Banner
ASCII_ART = """
    ▌     ▗     ▌    ▘   ▌         
▛▘▌▌▛▌█▌▛▘▜▘█▌▛▘▛▌▛▛▌▌▛▌▛▌  ▛▘▛▌▛▛▌
▙▖▙▌▙▌▙▖▌ ▐▖▙▖▙▖▌▌▌▌▌▌▌▌▙▌▗ ▙▖▙▌▌▌▌
  ▄▌                               
"""


# Usage Examples
USAGE_EXAMPLES = """
Examples:
  exploit.py -t localhost:3000 -c "whoami"
  exploit.py -t http://localhost:3000 -c "cat /etc/passwd"
  exploit.py -t http://localhost:3000 -c "ls -la /var/www"
  exploit.py -t http://localhost:3000 -c "id"
  exploit.py -t http://target.com -c "ps aux"
  exploit.py -t http://target.com -c "uname -a"
"""


# POC Database Entry (for seeding)
POC_METADATA = {
    'name': 'React2Shell - CVE-2025-55182 Exploit',
    'description': (
        'Automated exploitation tool for CVE-2025-55182. Crafts malicious payloads '
        'to achieve remote code execution on vulnerable Next.js servers running '
        'React Server Components.'
    ),
    'language': 'python',
    'usageExamples': USAGE_EXAMPLES.strip(),
    'author': TOOL.author
}


# Exploitation Configuration
EXPLOIT_CONFIG = {
    'timeout': 15,  # seconds
    'default_protocol': 'https',
    'boundary': '----CyberTechMindBoundaryX9K2pLvN4MqR8TdF',
    'user_agent_template': '{author}-Scanner/{version} ({website})',
    'max_retries': 3,
    'verify_ssl': False
}


# Export all configurations
__all__ = [
    'CVE',
    'TOOL', 
    'ASCII_ART',
    'USAGE_EXAMPLES',
    'POC_METADATA',
    'EXPLOIT_CONFIG',
    'CVEMetadata',
    'ToolMetadata'
]


# Convenience function to get all metadata as dict
def get_full_metadata():
    """Get complete metadata for platform integration"""
    return {
        'cve': CVE.to_dict(),
        'tool': TOOL.to_dict(),
        'poc': POC_METADATA,
        'config': EXPLOIT_CONFIG
    }
