# Exploit Orchestrator - Main Script

## Overview

The **Exploit Orchestrator** (`script.py`) is the main entry point for the Bug Hunting Platform's exploit management system. It auto-discovers all available POC exploits, displays their metadata, and provides an interactive interface for execution.

---

## Features

### ğŸ” Auto-Discovery

- Automatically finds all CVE directories in `exploits/`
- Loads configuration from each exploit's `__init__.py`
- Validates and organizes exploit metadata
- Sorts by CVE ID

### ğŸ“Š Rich Display

- Colorful ASCII art banner
- Detailed exploit listing with:
  - CVE ID and exploit name
  - Title and description
  - Severity rating with color coding
  - CVSS score
  - Author information
  - Affected products
  - Language/platform

### ğŸ¯ Multiple Execution Modes

- **Interactive Mode**: Menu-driven interface
- **Command Line Mode**: Direct commands
- **Integration Mode**: Easy platform integration

### ğŸ›¡ï¸ Safety Features

- Input validation
- Error handling
- Graceful interruption handling
- Script existence verification

---

## Usage

### Interactive Mode (Default)

```bash
cd python-core/exploits
python3 script.py
```

**Interactive Commands:**

- `l` - List all exploits
- `d <num>` - Show detailed info (e.g., `d 1`)
- `r <num>` - Run exploit (e.g., `r 1`)
- `h` - Show help
- `q` - Quit

**Example Session:**

```
> l
[Shows all exploits]

> d 1
[Shows CVE-2025-55182 details]

> r 1 -t localhost:3000 -c "whoami"
[Executes React2Shell exploit]

> q
```

### Command Line Mode

```bash# List all exploits
python3 script.py list

# Show exploit details
python3 script.py info 1

# Run exploit with arguments
python3 script.py run 1 -t localhost:3000 -c "whoami"

# Run exploit without args (shows help)
python3 script.py run 1
```

---

## Output Examples

### Main Banner

```
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â•     â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•   â•šâ•â•

POC Exploit Discovery & Execution Platform
```

### Exploit List

```
[1] CVE-2025-55182 - React2Shell
    Title: Next.js React Server Components Remote Code Execution
    Severity: CRITICAL (CVSS: 9.8)
    Author: Moovendhan V
    Language: python
    Affects: Next.js 13.x, Next.js 14.x, Next.js 15.x
```

### Detailed Info

```
Exploit Details:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
CVE ID: CVE-2025-55182
Title: Next.js React Server Components RCE
Severity: CRITICAL (CVSS: 9.8)

Description:
A critical remote code execution vulnerability in Next.js React Server
Components that allows attackers to execute arbitrary code...

Tool: CVE-2025-55182 RSC-RCE Exploit v1.0
Exploit Name: React2Shell
Author: Moovendhan V
Language: python

Affected Products:
  â€¢ Next.js 13.x
  â€¢ Next.js 14.x
  â€¢ Next.js 15.x

Published: 2025-01-15
Script Path: /path/to/exploit.py
```

---

## Architecture

### Auto-Discovery Process

```python
1. Scan exploits/ directory
2. Find all subdirectories
3. Check for __init__.py
4. Import configuration module
5. Extract CVE, TOOL, POC_METADATA
6. Build exploit registry
7. Sort by CVE ID
```

### Configuration Loading

```python
# For each CVE directory:
module = importlib.import_module('CVE_2025_55182')

cve = module.CVE          # CVEMetadata dataclass
tool = module.TOOL        # ToolMetadata dataclass
poc = module.POC_METADATA # Dictionary

# Extract relevant fields
config = {
    'cve_id': cve.cve_id,
    'title': cve.title,
    'severity': cve.severity,
    'tool_name': tool.tool_name,
    'exploit_path': 'path/to/exploit.py',
    # ... etc
}
```

### Execution Flow

```python
1. User selects exploit by number
2. Validate selection
3. Locate exploit script
4. Build command: python3 exploit.py [args]
5. Execute via subprocess
6. Display results
```

---

## Integration with Platform

### Database Seeding

```python
from exploits.script import ExploitOrchestrator

orchestrator = ExploitOrchestrator()
orchestrator.run([])  # Initialize

# Access discovered exploits
for exploit in orchestrator.exploits:
    # Insert into database
    await db.insert(schema.cves).values({
        'cveId': exploit['cve_id'],
        'title': exploit['title'],
        'severity': exploit['severity'],
        # ...
    })
```

### API Endpoint

```python
from exploits.script import ExploitDiscovery

@app.get("/api/exploits")
def list_exploits():
    discovery = ExploitDiscovery(Path("exploits"))
    exploits = discovery.discover_exploits()
    return {"exploits": exploits}
```

### Web UI Integration

```python
# Auto-populate exploit selection dropdown
discovery = ExploitDiscovery(Path("exploits"))
exploits = discovery.discover_exploits()

for exploit in exploits:
    # Add to UI
    add_to_dropdown(exploit['cve_id'], exploit['title'])
```

---

## Adding New Exploits

The orchestrator will automatically discover new exploits if they follow the pattern:

1. Create directory: `exploits/CVE-XXXX-XXXXX/`
2. Add `__init__.py` with configuration
3. Add `exploit.py` script
4. Run `script.py` - exploit appears!

**No configuration needed** - auto-discovery handles everything.

---

## Error Handling

### Missing Configuration

```
Warning: Failed to load CVE-2025-XXXXX: No module named 'CVE'
```

**Solution**: Ensure `__init__.py` exports `CVE` and `TOOL`

### Script Not Found

```
Error: Exploit script not found at /path/to/exploit.py
```

**Solution**: Verify `exploit.py` exists in CVE directory

### Invalid Selection

```
Invalid exploit number.
```

**Solution**: Use number from exploit list

---

## Severity Color Coding

- **LOW**: Blue
- **MEDIUM**: Yellow
- **HIGH**: Red
- **CRITICAL**: Bold Red

---

## Advanced Usage

### Programmatic Access

```python
from exploits.script import ExploitOrchestrator

# Initialize
orchestrator = ExploitOrchestrator()
orchestrator.run([])

# Get exploit by CVE ID
exploit = next(e for e in orchestrator.exploits if e['cve_id'] == 'CVE-2025-55182')

# Execute programmatically
orchestrator.execute_exploit(1, ['-t', 'localhost:3000', '-c', 'whoami'])
```

### Custom Discovery Path

```python
from exploits.script import ExploitDiscovery
from pathlib import Path

discovery = ExploitDiscovery(Path("/custom/exploits"))
exploits = discovery.discover_exploits()
```

---

## Platform Benefits

### 1. **Zero Configuration**

- Drop exploit in directory
- Auto-discovered instantly
- No manifest files needed

### 2. **Consistent Interface**

- All exploits accessed same way
- Uniform metadata structure
- Standardized execution

### 3. **Easy Testing**

- Quick exploit selection
- Interactive testing
- Immediate feedback

### 4. **Platform Integration**

- Auto-populate databases
- Generate API endpoints
- Sync with UI

### 5. **Scalability**

- Add unlimited exploits
- No performance degradation
- Efficient discovery

---

## Future Enhancements

- [ ] Exploit tagging/filtering
- [ ] Favorite/bookmark exploits
- [ ] Execution history
- [ ] Result caching
- [ ] Batch execution
- [ ] Export reports
- [ ] Search functionality
- [ ] Platform statistics

---

## Summary

The Exploit Orchestrator provides:

âœ… **Auto-discovery** of all CVE exploits  
âœ… **Interactive CLI** for easy testing  
âœ… **Command-line mode** for automation  
âœ… **Rich metadata display** with colors  
âœ… **Platform integration** ready  
âœ… **Zero configuration** for new exploits  
âœ… **Type-safe** via dataclass configs

This makes the Bug Hunting Platform highly usable and maintainable!
